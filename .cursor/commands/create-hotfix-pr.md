# HOTFIX COMMAND

-   **Base 브랜치**: `prod` + `stage` (운영 환경 긴급 수정 후 스테이징 동기화)
-   **브랜치 형식**: `hotfix/{issue-number}`
-   **PR 제목 형식**: `[HOTFIX] {제목} - prod` / `[HOTFIX] {제목} - stage`
-   **우선순위**: 최고 (긴급 배포 대상)
-   **자동 PR 생성**: prod PR 생성 후 자동으로 stage PR도 생성

## WORKFLOW

1. **HOTFIX 제목 확인**: `$ARGUMENTS`가 비어있으면 유저에게 HOTFIX 제목을 입력받아라.
2. **현재 브랜치 확인**: 현재 브랜치가 작업 브랜치(`hotfix/{issue-number}` 형식)인지 확인하라.
    - **이미 hotfix 브랜치인 경우**: 6번(커밋 수행) 단계로 바로 이동하라.
    - **Base 브랜치(prod)인 경우**: 3번(이슈 확인) 단계부터 진행하라.
    - **다른 브랜치인 경우**: prod 브랜치로 전환 후 3번 단계부터 진행하라.
3. **이슈 확인**: 이슈가 없으면 생성하고, 있으면 번호를 확인하라.
4. **브랜치 생성/전환**: 현재 브랜치가 이슈 번호 기반 형식이 아니면 `hotfix/{issue-number}` 형식으로 브랜치를 생성·전환하라.
5. **브랜치 전환 검증**: 브랜치가 `hotfix/{issue-number}` 형식으로 정상 전환되었는지 확인하라. 전환되지 않았으면 오류를 표시하고 중단하라.
6. **커밋 수행**: 논리적으로 관련된 작은 단위로 나눠서 커밋하라.
7. **원격 푸시**: 브랜치를 원격 저장소에 푸시하라.
8. **PR 생성 (prod)**: `[HOTFIX] {제목} - prod` 형식으로 `Resolved #이슈번호`로 시작하는 PR을 **prod 브랜치**로 생성하라.
9. **PR 생성 (stage)**: `[HOTFIX] {제목} - stage` 형식으로 동일한 `hotfix/{issue-number}` 브랜치로 **stage 브랜치**로도 PR을 생성하라. (이슈는 이미 prod PR에서 닫히므로 `Related to #이슈번호` 사용)

## COMMIT RULES

-   커밋 메시지는 **한국어 명령형 "~하라"**로 작성하라.
-   **여러 파일을 한 번에 커밋하지 말고, 논리적으로 관련된 작은 단위로 나눠서 커밋하라.**

## ISSUE TEMPLATE (HOTFIX용)

```md
## 버그 해결이나 기능 추가가 필요하다면 아래에 적어주세요

🚨 **긴급 운영 이슈**

(여기에 긴급하게 해결해야 할 운영 이슈를 작성)

## 해결 방안을 적어주세요

(여기에 해결 방안을 작성)

## 생각하고 있는 대안에 대해서 설명해주세요

(여기에 대안을 작성)

## 첨언할 내용이 있다면 적어주세요

(여기에 첨언을 작성)
```

## PR TEMPLATE (PROD용)

```md
## 개요🔎

Resolved #이슈번호

🚨 **긴급 운영 이슈 수정**

(여기에 HOTFIX 개요를 작성)

## 작업사항✍🏻

-   (여기에 작업 내역을 작성)

## 주의사항❗️

-   ⚠️ 긴급 배포 대상
-   (여기에 주의사항을 작성)

## 배포 계획

-   배포 대상: 운영 환경 (prod)
-   배포 시점: (배포 예정 시간)
```

## PR TEMPLATE (STAGE용)

```md
## 개요🔎

Related to #이슈번호

🚨 **HOTFIX 변경사항 stage 동기화**

prod 환경에 적용된 HOTFIX를 stage 환경에도 동기화합니다.

## 작업사항✍🏻

-   (여기에 작업 내역을 작성)

## 주의사항❗️

-   ⚠️ prod HOTFIX와 동일한 변경사항
-   prod PR 머지 후 stage PR도 머지 필요
```

## 예시

**명령어 실행**:

```
/create-hotfix-pr 필터매칭알림 메시지 한국어 변환 기능 추가
```

**생성되는 PR**:

1. **Prod PR**: `[HOTFIX] 필터매칭알림 메시지 한국어 변환 기능 추가 - prod` (hotfix/2313 → prod)
2. **Stage PR**: `[HOTFIX] 필터매칭알림 메시지 한국어 변환 기능 추가 - stage` (hotfix/2313 → stage)

**브랜치 구조**:

```
hotfix/2313 ┬→ prod  - prod  (긴급 배포)
            └→ stage - stage (동기화)
```

## 머지 순서

1. ✅ **Prod PR 머지** → 운영 환경 배포
2. ✅ **Stage PR 머지** → 스테이징 환경 동기화